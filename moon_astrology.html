<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="style33.css" type="text/css" />

</head>
<body>


<CENTER><FORM>
<INPUT type="Button" VALUE="Закрыть окно" onClick="self.close()">
</FORM></CENTER>

<div id="chasy4">
<p class="times">Сейчас:</p>
<div id="cal"></div>
</div>

<div class="body">

	<div class="birthday">
<img style="width:180px;" class="imgL" src="./img/china200.png"/>	
		<div class="icon">
			<div class="normal">
				
			</div>
			<div id="zod" class="zodiac">    </div>
		</div>
	     <p class="times" >Введите дату: годы - <span style="color:green">1900-2100</span>, месяцы - <span style="color:green">1-12</span>, дни - <span style="color:green">1-31/30/29/28</span>.</p>
		<input type="text" id="find1" class="month" maxlength="2" placeholder="Месяц"/><br><input type="text" id="find2" class="day"  maxlength="2" placeholder="День"/><br><input type="text" id="find" class="year" maxlength="4" placeholder="Год" /><br>
		<button class ="butt" onclick="a_value(this);" >submit</button>
		<button class ="butt1" onclick="a_value1(this);" >reset</button>
	<div id="zodiacc"></div>
<img style="width:180px;" class="imgR" src="./img/google-play-app_200.png"/>		
	</div>
	<div class="log"></div>

</div>

<div id="cal5"></div>
<p class="times" >Вы ввели дату:</p>
<div id="cal9" ></div>
<div id="chasy" class="empty">
<p class="times">Точка отсчета:<br>Последнее полнолуние 2019 г <span style="color:#026b4f">(по Киеву, UTC+2:00)</span>:</p>
<div id="cal10"></div>
</div>
<div id="chasy">
<p class="times">Лунный день (&asymp; в рамках 1 лунного дня)<br>по средней длительности синодического месяца<br><span style="color:#026b4f">на  07:13 по Киеву, UTC+2:00</span>:</p>
<div id="fases">
<img style="width:180px;" class="img1" src="./img/f7.png"/><img style="width:180px;" class="img2" src="./img/f6.png"/><img style="width:180px;" class="img3" src="./img/f5.png"/><img style="width:180px;" class="img4" src="./img/f4.png"/><img style="width:180px;" class="img5" src="./img/f3.png"/><img style="width:180px;" class="img6" src="./img/f2.png"/><img style="width:180px;" class="img7" src="./img/f1.png"/>	
</div>
<div id="cal8"></div>
<img class="giff" src="./img/200GIF.gif"/>
</div>

<div id="chasy">
<p class="times">Предыдущее новолуние:</p>
<div id="cal22"></div>
</div>

<div id="chasy">
<p class="times">Следующее новолуние:</p>
<div id="cal23"></div>
</div>



<div id="chasy">
<p class="times">Год:<br></p>
<div id="cal_1"></div><div id="cal_11"></div>
<p class="times">60-летнего цикла<br></p>
</div>

<div id="chasy1">

	<div class="divv">
	 <div id="left"></div>
	</div>

		<div class="center">
		<p class="times">Начало этого года по восточному календарю<br>(1-е новолуние в Водолее):</p>
		<div id="cal7"></div>
		</div>

	<div class="divv">
	 <div id="right"></div>
	</div>

</div>

<script src="js223.js"></script>

<script>
const D = (s, o = document) => o.getElementById(s);
var mInterval = 29.53058812;
var secDay = 86400;
var secMoonM = (mInterval*secDay*1000).toFixed(9);

var znak = ['Овца или Коза','Обезьяна','Петух','Собака','Кабан или Свинья','Крыса или Мышь','Бык','Тигр','	Кролик или Кот','Дракон','Змея','Лошадь','Овца или Коза'];

var secMoonM1 = ((mInterval*secDay*1000) - 86400).toFixed(9);

var options = {  
		  year: 'numeric',
		  month: 'long',
		  day: 'numeric',
		  weekday: 'long',
		  timezone: 'UTC',
		  hour: 'numeric',
		  minute: 'numeric',
		  second: 'numeric'
      };
var options4 = {  
		  year: 'numeric',
		  month: 'long',
		  day: 'numeric',
		  weekday: 'long',
		  timezone: 'UTC',
		  
      };	  
var options1 = {  
		  year: 'numeric',
		  month: 'numeric',
		  day: 'numeric',
		  weekday: 'long',
      };
var options2 = {  
         month: 'numeric',
};
var options3 = {  
		  day: 'numeric',		  
      };	  
//DATA
function setDate() {
	var d = new Date();
	var now =  d.toLocaleString("ru", options);  
		 D('cal').innerHTML = "<p>" + now + "</p>"; 		 
 }
setInterval(setDate, 1);
 //SET
 //ТОЧКА ОТСЧЕТА 
 //выводим точку отсчета 	
var dateX = new Date(2019, 11, 26, 7, 13, 12); 
var timeStart1 = dateX.getTime(); 
var str =  dateX.toLocaleString("ru", options);
    D('cal10').innerHTML =str;
//РАССЧЕТЫ
function a_value(o){
var dv = D('fases');
var elems = dv.getElementsByTagName('img');
for(var i=0; i<elems.length; i++) (elems[i]).style.opacity = 0.6;
	var b = D('find').value;
	var parseb = parseInt(b, 10);
	var b1 = D('find1').value;
	var parseb1 = parseInt(b1, 10);
	var b2 = D('find2').value;
	var parseb2 = parseInt(b2, 10);
	

//ПРОВЕРКА ОШИБОК ВВОДА	
if(parseb < 1900 || parseb > 2100 || parseb1 >12 || parseb1<1 || parseb2 < 1 || parseb2 > 31 || D('find').value === ''){
console.log(b,b1,b2);
		 D('cal5').innerHTML = 'Oшибка:'+b+b1+b2+'<p style=color:red>Недопустимая дата - (1900-2100 гг, 1-12 месяцы, 1-31/30/28 дни)</p>'; 
		 D('cal9').innerHTML = '';
		 D('cal8').innerHTML = '';
		 D('cal23').innerHTML = "" ; 
		 D('cal22').innerHTML = "" ; 
}else{
    D('cal5').innerHTML = "";	
	console.log(b,b1,b2);

 //ЗОДИАК ВОСТОЧНЫЙ 
 //60-летний цикл
if (b > 1983 && b < 2044){
D('cal_1').innerHTML = b-1983;
}else if(b < 1984 && b > 1923){D('cal_1').innerHTML = 60-(1983-b);}else if(b > 2043){D('cal_1').innerHTML = b-2043;}else{D('cal_1').innerHTML = 60-(1923-b);}
//знаки
var zni = b%12+1;
var zni1 = zni-1;
console.log(zni);
D('right').innerHTML = '<p class=times>Наступает:<br></p>' + znak[zni]+'<img src=./img/' + zni + '.png>';
D('left').innerHTML = '<p class=times>Уходит:<br></p>' + znak[zni-1]+'<img src=./img/' + zni1 + '.png>';
	
  //ФУНКЦИЯ дата по миллисекундам 
 var currentDay; 
 
//выводим выбранную дату  
var mh = new Date(b,b1-1,b2);  
var select =  mh.toLocaleString("ru", options4);  
    D('cal9').innerHTML = "<p style=color:#0a0aad;font-style:italic;font-size:18px;>"+select+"</p>";
 
//начало года по КИТАЮ
	var mhCH = new Date(b,1);
	var stCH =  mhCH.toLocaleString("ru", options1);
	var stCHm =  mhCH.toLocaleString("ru", options2);
	var stCHd =  mhCH.toLocaleString("ru", options3);
    var SelectMoonMonthCH = Math.abs((timeStart1-mhCH.getTime())/secMoonM).toFixed(9);	   
	var minDataCH = Math.floor(SelectMoonMonthCH); 	
 
            var fgCH = new Date((Math.ceil(SelectMoonMonthCH)*secMoonM));
		    var fg1CH = new Date((Math.floor(SelectMoonMonthCH)*secMoonM));
var ngCH, ng1CH, str4CHm, str4CHd, str4CH, str4aCHm, str4aCHd, str4aCH; 

//считаем количество лунных месяцев между выбранной и нулевой датой 	
	var SelectMoonMonth1 = Math.abs((timeStart1-mh.getTime())/secMoonM).toFixed(9);	   
	var minData1 = Math.floor(SelectMoonMonth1);
	var minData2 = Math.ceil(SelectMoonMonth1);

 
//ВЫЧИСЛЯЕМ ЛУННЫЙ ДЕНЬ, УБЫЫВАНИЕ_РОСТ
//ЕСЛИ выбранная дата < 2020, то от нуля отнимаем, если больше - прибывляем 	
 if( b < 2020){
 //начало года по китаю < 2020
								  
								        ngCH = new Date((timeStart1-fgCH.getTime()));
										ng1CH = new Date((timeStart1-fg1CH.getTime()));
										   str4CHm =  ngCH.toLocaleString("ru", options2);
										   str4CHd =  ngCH.toLocaleString("ru", options3);
										   str4CH =  ngCH.toLocaleString("ru", options4);
											   str4aCHm =  ng1CH.toLocaleString("ru", options2);
											   str4aCHd =  ng1CH.toLocaleString("ru", options3);
											   str4aCH =  ng1CH.toLocaleString("ru", options4);
											   console.log(str4CHd,str4CHm);
											   console.log(str4aCHd,str4aCHm);
											if(str4CHm == 1 && str4CHd < 20 || str4CHm == 2 && str4CHd>20)
											{ 
											   D('cal7').innerHTML = str4aCH ;
											    }else{
												D('cal7').innerHTML = str4CH ;
												};
											
 
 
 currentDay = Math.round((1-(Math.abs(SelectMoonMonth1 - minData1)))*29.53058812);
 console.log(currentDay);
          //ПО РАЗНИЦЕ ОПРЕДЕЛЯЕМ УБЫВАНИЕ_РОСТ
	     if((Math.round(SelectMoonMonth1)-SelectMoonMonth1) > 0.01){
	        D('cal8').innerHTML ="<p style=font-size:20px;font-weight:bold;>"+currentDay +"</p>"  + "<p style=color:#188503;>Растущая луна</p>" ;
	               if(currentDay == 15 || currentDay == 16){
				   console.log(currentDay);
				   D('cal8').innerHTML ="<p style=font-size:20px;font-weight:bold;>"+currentDay +"</p>"  + "<p style=color:blue;>Полнолуние</p>";
				      
				      $('.img4').style.opacity = 1;
				   }
				   if(currentDay == 29 || currentDay == 0 || currentDay == 1 || currentDay == 30){
				   console.log(currentDay);
				   D('cal8').innerHTML ="<p style=font-size:20px;font-weight:bold;>"+currentDay +"</p>"  + "<p style=color:blue;>Новолуние</p>";
				      $('.img1').style.opacity = 1;
					  $('.img7').style.opacity = 1;
				   }
						   if(currentDay >1 && currentDay <7){ $('.img2').style.opacity = 1;}
						   if(currentDay >6 && currentDay <15){$('.img3').style.opacity = 1;}
						   if(currentDay >16 && currentDay <22){$('.img5').style.opacity = 1;}
						   if(currentDay >21 && currentDay <29){$('.img6').style.opacity = 1;}
				   
					   var fg = new Date((Math.ceil(SelectMoonMonth1)*secMoonM));
					   var ng = new Date((timeStart1-fg.getTime()));
						   var fg1 = new Date((Math.floor(SelectMoonMonth1)*secMoonM));
						   var ng1 = new Date((timeStart1-fg1.getTime()));
					   var str4 =  ng.toLocaleString("ru", options);
					  var str4a =  ng1.toLocaleString("ru", options);
					   D('cal22').innerHTML = str4 ;
							D('cal23').innerHTML = str4a ;
                                      
				    
	      }else{
console.log(currentDay);
												
		    D('cal8').innerHTML ="<p style=font-size:20px;font-weight:bold;>"+currentDay  + "<p style=color:#212f40;>Убывающая луна</p>";
			       if(currentDay == 15 || currentDay == 16){D('cal8').innerHTML ="<p style=font-size:20px;font-weight:bold;>"+currentDay  + "<p style=color:blue;>Полнолуние</p>";
				     $('.img4').style.opacity = 1;
				   }
				   if(currentDay == 29 || currentDay == 0 || currentDay == 1 || currentDay == 30 ){D('cal8').innerHTML ="<p style=font-size:20px;font-weight:bold;>"+currentDay  + "<p style=color:blue;>Новолуние</p>";
				     $('.img1').style.opacity = 1;
					 $('.img7').style.opacity = 1;
				   } console.log(currentDay);
				           if(currentDay >1 && currentDay <7){ $('.img2').style.opacity = 1;}
						   if(currentDay >6 && currentDay <15){$('.img3').style.opacity = 1;}
						   if(currentDay >16 && currentDay <22){$('.img5').style.opacity = 1;}
						   if(currentDay >21 && currentDay <29){$('.img6').style.opacity = 1;}
				       var fg = new Date((Math.ceil(SelectMoonMonth1)*secMoonM));
					   let ng = new Date((timeStart1-fg.getTime()));
						   var fg1 = new Date((Math.floor(SelectMoonMonth1)*secMoonM));
						   let ng1 = new Date((timeStart1-fg1.getTime()));
					   var str4 =  ng.toLocaleString("ru", options);
							var str4a =  ng1.toLocaleString("ru", options);
					   D('cal22').innerHTML = str4 ;
							D('cal23').innerHTML = str4a ;
		  }
}else{
//начало года по китаю > 2019
								  
								        ngCH = new Date((timeStart1+fgCH.getTime()));
										ngCH.setDate(ngCH.getDate() + 1);
										ng1CH = new Date((timeStart1+fg1CH.getTime()));
										 ng1CH.setDate(ng1CH.getDate() + 1);
										  str4CHm =  ngCH.toLocaleString("ru", options2);
										   str4CHd =  ngCH.toLocaleString("ru", options3);
										   str4CH =  ngCH.toLocaleString("ru", options4);
										       str4aCHm =  ng1CH.toLocaleString("ru", options2);
											   str4aCHd =  ng1CH.toLocaleString("ru", options3);
											   str4aCH =  ng1CH.toLocaleString("ru", options4);
											  
											if((str4aCHm == 1 && str4aCHd < 20) || (str4aCHm == 2 && str4aCHd > 20 ) )
											{D('cal7').innerHTML = str4CH ;}else{D('cal7').innerHTML = str4aCH ;};
												
  currentDay = Math.round((Math.abs(SelectMoonMonth1 - minData1))*29.53058812);
  console.log(currentDay);
	   if((Math.round(SelectMoonMonth1)-SelectMoonMonth1) > 0.01){
	        D('cal8').innerHTML = "<p style=font-size:20px;font-weight:bold;>"+currentDay  + "<p style=color:#212f40;>Убывающая луна</p>";
			       if(currentDay == 16 || currentDay == 15){D('cal8').innerHTML ="<p style=font-size:20px;font-weight:bold;>"+currentDay +"</p>"  + "<p style=color:blue;>Полнолуние</p>";
				     $('.img4').style.opacity = 1;
				   }
				   if(currentDay == 29 || currentDay == 0 || currentDay == 1 || currentDay == 30){D('cal8').innerHTML ="<p style=font-size:20px;font-weight:bold;>"+currentDay +"</p>"  + "<p style=color:blue;>Новолуние</p>";
				     $('.img1').style.opacity = 1;
					 $('.img7').style.opacity = 1;
				   }
				   
				           if(currentDay >1 && currentDay <7){ $('.img2').style.opacity = 1;}
						   if(currentDay >6 && currentDay <15){$('.img3').style.opacity = 1;}
						   if(currentDay >16 && currentDay <22){$('.img5').style.opacity = 1;}
						   if(currentDay >21 && currentDay <29){$('.img6').style.opacity = 1;}
				   
				      var fg = new Date((Math.ceil(SelectMoonMonth1)*secMoonM));
					   let ng = new Date((timeStart1+fg.getTime()));
					   var fg1 = new Date((Math.floor(SelectMoonMonth1)*secMoonM));
					   let ng1 = new Date((timeStart1+fg1.getTime()));
					   var str4 =  ng.toLocaleString("ru", options);
					   var str4a =  ng1.toLocaleString("ru", options);
					   D('cal23').innerHTML = str4 ;
					   D('cal22').innerHTML = str4a ;
	      }else{
		    D('cal8').innerHTML =  "<p style=font-size:20px;font-weight:bold;>"+currentDay  + "<p style=color:#188503;>Растущая луна</p>";
			       if(currentDay == 16 || currentDay == 15){D('cal8').innerHTML ="<p style=font-size:20px;font-weight:bold;>"+currentDay +"</p>"  + "<p style=color:blue;>Полнолуние</p>";
				      $('.img4').style.opacity = 1;
				   }
				   if(currentDay == 29 || currentDay == 0 || currentDay == 1 || currentDay == 30){D('cal8').innerHTML ="<p style=font-size:20px;font-weight:bold;>"+currentDay +"</p>"  + "<p style=color:blue;>Новолуние</p>";
				    $('.img1').style.opacity = 1;
					$('.img7').style.opacity = 1;
				   }
				            if(currentDay >1 && currentDay <7){ $('.img2').style.opacity = 1;}
						   if(currentDay >6 && currentDay <15){$('.img3').style.opacity = 1;}
						   if(currentDay >16 && currentDay <22){$('.img5').style.opacity = 1;}
						   if(currentDay >21 && currentDay <29){$('.img6').style.opacity = 1;}
				       var fg = new Date((Math.ceil(SelectMoonMonth1)*secMoonM));
					   let ng = new Date((timeStart1+fg.getTime()));
					   var fg1 = new Date((Math.floor(SelectMoonMonth1)*secMoonM));
					   let ng1 = new Date((timeStart1+fg1.getTime()));
					   var str4 =  ng.toLocaleString("ru", options);
					   var str4a =  ng1.toLocaleString("ru", options);
					   D('cal23').innerHTML = str4 ;
					   D('cal22').innerHTML = str4a ;
		  }
  }	
 }	
}
//RESET
function a_value1(o){	
	D('find').value = "";
	D('find1').value = "";
	D('find2').value = "";
	D('cal5').innerHTML = "";	
	D('cal8').innerHTML = "" ; 
	D('cal9').innerHTML = "" ; 
	D('cal22').innerHTML = "" ; 
	D('cal_1').innerHTML = "" ; 
	D('cal7').innerHTML = "" ; 
	D('right').innerHTML = "" ; 
	D('left').innerHTML = "" ;
	D('zodiacc').innerHTML = "" ;
	if(($('.birthday [class *= "show"]')) !== null){
	$('.birthday [class *= "show"]').innerHTML = "" ;}
	var dv = D('fases');
var elems = dv.getElementsByTagName('img');
for(var i=0; i<elems.length; i++) (elems[i]).style.opacity = 0.6;
}

</script>
</body>

</html>